let path = import.meta.url
export default class fdsHelper {

    static async getInfo(type,componentname){
        let fetchurl = "";
        let alternativefetchurl = "";
        let notfound = false;
        if(componentname){
            componentname = componentname.replace("@fds-components/","");
            fetchurl  = fdsHelper.get_href()+type+"-"+componentname+".json";
            alternativefetchurl =  `@fds-components/${componentname}/dist/${type}-${componentname}.json`;
        }

        let res = await fetch(fetchurl)
            .then(response => {
                if (!response.ok) {
                    notfound = true;
                }
                return response.json();
            })
            .then(data => {
                if (type!=="api") return data
                if (!data) return
                if (!data.components) return data
                return data.components[0]
            });
            if(notfound) {
                res = await fetch(alternativefetchurl)
                    .then(response => {
                        if (!response.ok) {
                            notfound = true;
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (type !== "api") return data
                        if (!data) return
                        if (!data.components) return data
                        return data.components[0]
                    });
            }
        return res;
    }


    static get_href() {
        return new URL('./', path).href
    }

    static get_local() {
        return new URL('./', path).pathname
    }
}
